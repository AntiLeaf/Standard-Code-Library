对每个点找出最小的入边, 如果是一个DAG那么就已经结束了.

否则把环都缩起来再跑一遍, 直到没有环为止.

可以用可并堆优化到$O(m\log n)$, 需要写一个带懒标记的左偏树.