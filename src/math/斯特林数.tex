\textbf{第一类斯特林数}

$n\brack k$表示$n$个元素划分成$k$个轮换的方案数.

求同一行: 分治FFT $O(n\log ^2 n)$

求同一列: 用一个轮换的指数生成函数做$k$次幂
$$\begin{aligned} \sum_{n = 0} ^ \infty {n \brack k} \frac {x ^ n} {n!} = \frac {\left(\ln (1 - x)\right) ^ k} {k!} \end{aligned}$$

\textbf{第二类斯特林数}

$n\brace k$表示$n$个元素划分成$k$个子集的方案数.

求一个: 容斥, 狗都会做

$$\begin{aligned} {n \brace k} = \frac 1 {k!} \sum_{i = 0} ^ k (-1) ^ i {k \choose i} (k - i) ^ n \end{aligned}$$

求同一行: FFT, 狗都会做

求同一列: 指数生成函数
$$\begin{aligned} \sum_{n = 0} ^ \infty {n \brace k} \frac {x ^ n} {n!} = \frac {\left(e ^ x - 1\right) ^ k} {k!} \end{aligned}$$
普通生成函数
$$\begin{aligned} \sum_{n = 0} ^ \infty {n \brace k} x ^ n = x ^ k \left(\prod_{i = 1} ^ k (1 - i x)\right) ^ {-1} \end{aligned}$$